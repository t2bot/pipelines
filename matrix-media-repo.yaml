steps:
  - label: "üî® Build :go: 1.14"
    commands: 
      - "./build.sh"
    plugins:
      - docker#v3.0.1:
          image: "golang:1.14"
          mount-buildkite-agent: false
  - label: "ü§ù Complement"
    env:
      COMPLEMENT_BASE_IMAGE: complement-media-repo
      COMPLEMENT_VERSION_CHECK_ITERATIONS: 400
    commands: 
      - "chown -R buildkite-agent:buildkite-agent /var/lib/buildkite-agent/builds/buildkite-01-1/t2bot/matrix-media-repo"
      - "docker build -t complement-media-repo -f Complement.Dockerfile --user $(id -u):$(id -g) ."
      - "chmod +x ci-complement.sh" # To fix the script
      - "./ci-complement.sh"
